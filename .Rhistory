summarise(inflow_vol_L = sum(vol_diff, na.rm = TRUE))
## SPRC Nutrients ##
SPRC_nutrient_file <- "SPRC_surface_water_nutrient_WY25-v1.0_20250721.csv"
SPRC_conc_df <- read.csv(SPRC_nutrient_file)
head(SPRC_conc_df)
#match up LOIs with coord -- Raissa's code
lois <- read_csv("./locations_of_interest.csv")
# Convert coordinates to sf, ensure same CRS
data.coords.sf <- st_as_sf(SPRC_conc_df %>%
filter(!is.na(coord_x) & !is.na(coord_y)),
coords = c('coord_x', 'coord_y'),
crs = 'EPSG: 4326')
lois.centroids.sf <- st_as_sf(lois %>%
filter(!is.na(loi_lon)|!is.na(loi_lat)),
coords = c('loi_lon', 'loi_lat'),
crs = 'EPSG: 4326')
# Get nearest LOI for each coordinate pair
nearest_id <- st_nearest_feature(data.coords.sf, lois.centroids.sf)
# Get distance between each coordinate pair and its nearest LOI
nearest_dist <- st_distance(data.coords.sf,
lois.centroids.sf[nearest_id,],
by_element = TRUE)
# Combine results into a new dataframe
matched_loc <-
bind_cols(SPRC_conc_df %>% filter(!is.na(coord_x) & !is.na(coord_y)),
nearest_dist = nearest_dist) %>%
mutate(loc_coords = lois.centroids.sf[nearest_id, 'loi_id']$loi_id,
loc_coords_name = lois.centroids.sf[nearest_id, 'loi_name']$loi_name)
#create monthyl concentrations by LOI
SPRC_nutrients <- matched_loc %>%
separate(datetime, c("date", "time"), sep = " ") %>%
mutate(date = as.factor(format(as.Date(date, format = "%m/%d/%Y"), "%m/%Y"))) %>%
select(loc_coords,
date,
tn_mgL,
tp_mgL,
nitrate_nitrite_mgL,
total_ammonia_mgL,
urea_mgL,
drp_mgL) %>%
#average monthly concentrations
aggregate(. ~ date + loc_coords,
FUN = mean,
na.rm = TRUE)
View(SPRC_nutrients)
#create monthyl concentrations by LOI
SPRC_nutrients <- matched_loc %>%
separate(datetime, c("date", "time"), sep = " ") %>%
mutate(date = as.factor(format(as.Date(date, format = "%m/%d/%Y"), "%m/%Y"))) %>%
select(loc_coords,
date,
tn_mgL,
tp_mgL,
nitrate_nitrite_mgL,
total_ammonia_mgL,
urea_mgL,
drp_mgL) %>%
#average monthly concentrations
aggregate(. ~ date + loc_coords,
FUN = mean,
na.rm = TRUE)
## SPRC Load Calculation ##
#use Olivia's for-loop to make a df of each LOI
loc <- c("SPRC_01", "SPRC_02", "SPRC_03", "SPRC_04")
for(i in 1:length(loc)){
assign(paste0(loc[i],"_nut"),
subset(SPRC_nutrients,loc_coords == loc[i]))
}
#calculate second TT load (TT2)
#calculate load at the inlet
SPRC_03_nut <- merge(SPRC_03_nut, SPRC_04_volume, by = "date")
SPRC_03_nut <- SPRC_03_nut %>%
#calculate load in mg and pounds
mutate(across(tn_mgL:drp_mgL, ~. * (inflow_vol_L/453592.37), .names = "lbsIN_{.col}")) %>%
select(date,
lbsIN_tn_mgL:lbsIN_drp_mgL)
#calculate the load at the outlet
SPRC_04_nut <- merge(SPRC_04_nut, SPRC_04_volume, by = "date")
SPRC_04_nut <- SPRC_04_nut %>%
#calculate load in mg and pounds
mutate(across(tn_mgL:drp_mgL, ~. * (inflow_vol_L/453592.37), .names = "lbsOUT_{.col}")) %>%
select(date,
lbsOUT_tn_mgL:lbsOUT_drp_mgL)
#combine and find retained
SPRC_TT2_load <- SPRC_03_nut %>%
merge(SPRC_04_nut, by = "date") %>%
mutate(TT2_Nfiltered_lbs = lbsIN_tn_mgL - lbsOUT_tn_mgL,
TT2_Pfiltered_lbs = lbsIN_tp_mgL - lbsOUT_tp_mgL,
TT2_NOxfiltered_lbs = lbsIN_nitrate_nitrite_mgL - lbsOUT_nitrate_nitrite_mgL,
TT2_NH4filtered_lbs = lbsIN_total_ammonia_mgL - lbsOUT_total_ammonia_mgL,
TT2_DRPfiltered_lbs = lbsIN_drp_mgL - lbsOUT_drp_mgL) %>%
select(date,
TT2_Nfiltered_lbs:TT2_DRPfiltered_lbs)
View(SPRC_TT2_nut)
View(SPRC_TT2_load)
SPRC_nutrients <- matched_loc %>%
separate(datetime, c("date", "time"), sep = " ")
View(SPRC_nutrients)
SPRC_wll8 <- read.csv("WS_SPRC_04_h2ohio_wll08_proc-comb.csv")
library(sf)
library(dplyr)
library(tidyverse)
library(readr)
library(measurements)
SPRC_wll8 <- read.csv("WS_SPRC_04_h2ohio_wll08_proc-comb.csv")
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26)
View(SPRC_02_sol)
SPRC_04_sol_file <- "WS_SPRC_04_h2ohio_wll06_proc-comb.csv"
SPRC_04_sol <- read.csv(SPRC_04_sol_file)
View(SPRC_04_sol)
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_04_sol$datetime, format = "%m/%d/%Y")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_04_sol$datetime, format = "%m/%d/%Y")
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y")
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime != 12-11-23:12-16-23)
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime != 12-11-23:12-16-23)
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime != 2023-12-11:2023-12-16)
SPRC_02_sol <- SPRC_02_sol %>%
filter(between(datetime, as.Date('2023-11-29'), as.Date('2023-12-10') &
datetime, as.Date('2023-12-17'), as.Date('2024-04-03') &
datetime, as.Date('2024-04-18'), as.Date('2024-11-28') &
datetime, as.Date('2025-03-11'), as.Date('2025-06-16')))
SPRC_02_sol <- SPRC_02_sol %>%
filter(between(datetime, as.Date('2023-11-29'), as.Date('2023-12-10') |
datetime, as.Date('2023-12-17'), as.Date('2024-04-03') |
datetime, as.Date('2024-04-18'), as.Date('2024-11-28') |
datetime, as.Date('2025-03-11'), as.Date('2025-06-16')))
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime < 2023-12-10 |
2023-12-17 < datetime < 2024-04-03 |
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime < "2023-12-10" |
"2023-12-17" < datetime < "2024-04-03" |
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime == 2023-11-29:2023-12-10 |
datetime == 2023-12-17:2024-04-03 |
datetime == 2024-04-18:2024-11-28 |
datetime < 2025-03-11)
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime %in% 2023-11-29:2023-12-10 |
datetime %in% 2023-12-17:2024-04-03 |
datetime %in% 2024-04-18:2024-11-28 |
datetime < 2025-03-11)
SPRC_02_sol <- SPRC_02_sol %>%
filter(datetime %in% 2023-11-29:2023-12-10 |
datetime %in% 2023-12-17:2024-04-03 |
datetime %in% 2024-04-18:2024-11-28 |
datetime < 2025-06-16)
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y")
SPRC_02_sol <- SPRC_02_sol %>%
filter!(datetime %in% 2023-12-11:2023-12-16 &
SPRC_02_sol <- SPRC_02_sol %>%
filter!(datetime %in% 2023-12-11:2023-12-16 |
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y")
SPRC_02_sol <- SPRC_02_sol[!(SPRC_02_sol$datetime %in%
c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10))]
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y")
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in%
c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10)))
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in%
c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10)))
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in%
c("2023-12-11":"2023-12-16",
"2024-04-03":"2024-04-17",
"2024-11-24":"2025-03-10")))
unusable_dates <- c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10)
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y")
unusable_dates <- c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10)
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in% unusable_dates))
unusable_dates <- c(as.Date(2023-12-11:2023-12-16),
as.Date(2024-04-03:2024-04-17),
as.Date(2024-11-24:2025-03-10))
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in% unusable_dates))
unusable_dates <- c(as.Date(2023-12-11):as.Date(2023-12-16),
as.Date(2024-04-03):as.Date(2024-04-17),
as.Date(2024-11-24):as.Date(2025-03-10))
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in% unusable_dates))
unusable_dates
unusable_dates <- c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10)
unusable_dates
unusable_dates <- c(2023-12-11:2023-12-16,
2024-04-03:2024-04-17,
2024-11-24:2025-03-10) %>%
as.POSIXct(format = "%m/%d/%Y")
unusable_dates
###############################################################################
#THIS IS ALL NOT WORKING, COME BACK TO IT LATER
unusable_dates <- c(2023-12-11:2023-12-16)
unusable_dates
unusable_dates <- c(2023-12-11:2023-12-16)%>%
as.POSIXct(format = "%m/%d/%Y")
unusable_dates
unusable_dates <- c(seq(as.POSIXct("2023-12-11",format = "%m/%d/%Y"),
as.POSIXct("2023-12-16",format = "%m/%d/%Y")),
seq(as.POSIXct("2024-04-03",format = "%m/%d/%Y"),
as.POSIXct("2024-04-17",format = "%m/%d/%Y")),
seq(as.POSIXct("2024-11-29",format = "%m/%d/%Y"),
as.POSIXct("2025-03-10",format = "%m/%d/%Y")))
unusable_dates <- c(seq(as.POSIXct("2023-12-11", format = "%m/%d/%Y"),
as.POSIXct("2023-12-16", format = "%m/%d/%Y")),
seq(as.POSIXct("2024-04-03", format = "%m/%d/%Y"),
as.POSIXct("2024-04-17", format = "%m/%d/%Y")),
seq(as.POSIXct("2024-11-29", format = "%m/%d/%Y"),
as.POSIXct("2025-03-10", format = "%m/%d/%Y")))
unusable_dates <- c(seq(as.POSIXct("2023-12-11", format = "%m/%d/%Y"),
as.POSIXct("2023-12-16", format = "%m/%d/%Y"),
by = "day"),
seq(as.POSIXct("2024-04-03", format = "%m/%d/%Y"),
as.POSIXct("2024-04-17", format = "%m/%d/%Y"),
by = "day"),
seq(as.POSIXct("2024-11-29", format = "%m/%d/%Y"),
as.POSIXct("2025-03-10", format = "%m/%d/%Y"),
by = "day"))
unusable_dates <- c(seq(as.POSIXct("2023-12-11", format = "%m/%d/%Y"),
as.POSIXct("2023-12-16", format = "%m/%d/%Y"),
by = "day"),
seq(as.POSIXct("2024-04-03", format = "%m/%d/%Y"),
as.POSIXct("2024-04-17", format = "%m/%d/%Y"),
by = "day"),
seq(as.POSIXct("2024-11-29", format = "%m/%d/%Y"),
as.POSIXct("2025-03-10", format = "%m/%d/%Y"),
by = "day"))
unusable_dates <- c(seq(as.Date("2023-12-11", format = "%m/%d/%Y"),
as.Date("2023-12-16", format = "%m/%d/%Y"),
by = "day"),
unusable_dates
seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day")
seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day")
unusable_dates <- c(seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day"),
seq(as.Date("2024-04-03"), as.Date("2024-04-17"), by = "day"),
seq(as.Date("2024-11-29"), as.Date("2025-03-10"), by = "day")
unusable_dates <- c(seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day"),
unusable1 <- seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day")
unusable2 <- seq(as.Date("2024-04-03"), as.Date("2024-04-17"), by = "day")
unusable3 <- seq(as.Date("2024-11-29"), as.Date("2025-03-10"), by = "day")
unusable_dates <- c(unusable1, unusable2, unusable3)
unusable_dates
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in% unusable_dates))
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y")
SPRC_02_sol <- subset(SPRC_02_sol, !(datetime %in% unusable_dates))
SPRC_02_sol <- SPRC_02_sol %>%
filter(!datetime %in% unusable_dates)
unusable_dates <- c(unusable1, unusable2, unusable3) %>%
as.POSIXct(format = "%m/%d/%Y")
SPRC_02_sol <- SPRC_02_sol %>%
filter(!datetime %in% unusable_dates)
unusable_dates <- c(unusable1, unusable2, unusable3) <-
as.POSIXct(format = "%m/%d/%Y")
unusable_dates <- c(unusable1, unusable2, unusable3) %>%
as.POSIXct(format = "%m/%d/%Y")
unusable_dates
str(SPRC_02_sol)
unusable_dates
head(SPRC_02_sol$datetime)
unusable_dates <- c(unusable1, unusable2, unusable3) %>%
as.POSIXct(format = "%m/%d/%Y", tz = "EST")
SPRC_02_sol <- SPRC_02_sol %>%
filter(!datetime %in% unusable_dates)
unusable1 <- seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day")
unusable2 <- seq(as.Date("2024-04-03"), as.Date("2024-04-17"), by = "day")
unusable3 <- seq(as.Date("2024-11-29"), as.Date("2025-03-10"), by = "day")
unusable_dates <- c(unusable1, unusable2, unusable3) %>%
as.POSIXct(format = "%m/%d/%Y", tz = "EST")
SPRC_02_sol <- SPRC_02_sol %>%
filter(!datetime %in% unusable_dates)
SPRC_02_sol %>% filter(datetime %in% unusable_dates)
unusable_dates
unusable1
c(unusable1, unusable2, unusable3)
unusable_dates <- c(unusable1, unusable2, unusable3)
SPRC_02_sol <- SPRC_02_sol %>%
filter(!as.Date(datetime) %in% unusable_dates)
SPRC_02_sol
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.POSIXct(SPRC_02_sol$datetime, format = "%m/%d/%Y", tz = "EST")
#set unusable dates and remove
unusable1 <- seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day")
unusable2 <- seq(as.Date("2024-04-03"), as.Date("2024-04-17"), by = "day")
unusable3 <- seq(as.Date("2024-11-29"), as.Date("2025-03-10"), by = "day")
unusable_dates <- c(unusable1, unusable2, unusable3)
SPRC_02_sol <- SPRC_02_sol %>%
filter(!as.Date(datetime) %in% unusable_dates)
el_change1 <- seq(as.Date("2024-104-17"), as.Date("2024-16-18"), by = "day")
#set elevations to account for Solinst changes
el_change1 <- seq(as.Date("2024-04-17"), as.Date("2024-16-18"), by = "day")
#set elevations to account for Solinst changes
el_change1 <- seq(as.Date("2024-04-17"), as.Date("2024-06-18"), by = "day")
el_change2 <- seq(as.Date("2025-05-28"), as.Date("2025-06-16"), by = "day")
el_change2
#combine SPRC_02 HOBO and Solinst data
SPRC_02_volume <- SPRC_HOBO_volume %>%
#pull out HOBO from North Pool
filter(location == "SPRC_02") %>%
#combine two dfs
rbind(SPRC_02_sol)
View(SPRC_04_volume)
View(SPRC_02_volume)
set_el <- function(x) {
if (x %in% el_change1) {return(824.15)}
if (x %in% el_change2) {return(823.96)}
else {return(822)}
}
set_el(2023-09-20)
set_el(2023-04-28)
set_el <- function(x) {
if (as.Date(x) %in% el_change1) {return(824.15)}
if (as.Date(x) %in% el_change2) {return(823.96)}
else {return(822)}
}
set_el(2023-09-20)
set_el(2023-04-28)
set_el(2024-04-28)
el_change1
set_el <- function(x) {
if (as.Date("x") %in% el_change1) {return(824.15)}
if (as.Date("x") %in% el_change2) {return(823.96)}
else {return(822)}
}
set_el <- function(x) {
if (as.Date("x") %in% el_change1) {return(824.15)}
if (as.Date("x") %in% el_change2) {return(823.96)}
else {return(822)}
}
set_el(2023-09-20)
set_el <- function(x) {
if (as.Date(x) %in% el_change1) {return(824.15)}
if (as.Date(x) %in% el_change2) {return(823.96)}
else {return(822)}
}
set_el(2023-09-20)
set_el(2024-04-28)
SPRC_02_volume <- SPRC_02_volume %>%
mutate(sensor_el = case_when(datetime %in% el_change1 ~ as.numeric(824.15),
datetime %in% el_change2 ~ as.numeric(823.96)
.default = as.numeric(822)))
SPRC_02_volume <- SPRC_02_volume %>%
mutate(sensor_el = case_when(datetime %in% el_change1 ~ as.numeric(824.15),
datetime %in% el_change2 ~ as.numeric(823.96),
.default = as.numeric(822)))
library(tidyverse)
SPRC_02_volume <- SPRC_02_volume %>%
mutate(sensor_el = case_when(datetime %in% el_change1 ~ as.numeric(824.15),
datetime %in% el_change2 ~ as.numeric(823.96),
.default = as.numeric(822)))
library(sf)
library(dplyr)
library(tidyverse)
library(readr)
library(measurements)
#####################################
## SPRC ##
#####################################
#Author: Mary Ellen Klukow
#email: mklukow@kent.edu
## SPRC Hydrology ##
#inlet SPRC_01 to outlet SPRC_02; then inlet SPRC_03 to outlet SPRC_04
## UPDATE CSVs TO MOST RECENT RELEASE BEFORE RUNNING
#merge HOBO and Solinst data to find water level (m) for SPRC 02 and SPRC 04
#water level from HOBO data
SPRC_hobo_file <- "SPRC_hobo_WY25-v1.0_20250722.csv"
SPRC_HOBO_volume <- read.csv(SPRC_hobo_file) %>%
select("location",
"datetime",
"water_level_m")
SPRC_HOBO_volume$datetime <-
as.Date(SPRC_HOBO_volume$datetime)
library(sf)
library(dplyr)
library(tidyverse)
library(readr)
library(measurements)
#####################################
## SPRC ##
#####################################
#Author: Mary Ellen Klukow
#email: mklukow@kent.edu
## SPRC Hydrology ##
#inlet SPRC_01 to outlet SPRC_02; then inlet SPRC_03 to outlet SPRC_04
## UPDATE CSVs TO MOST RECENT RELEASE BEFORE RUNNING
#merge HOBO and Solinst data to find water level (m) for SPRC 02 and SPRC 04
#water level from HOBO data
SPRC_hobo_file <- "SPRC_hobo_WY25-v1.0_20250722.csv"
SPRC_HOBO_volume <- read.csv(SPRC_hobo_file) %>%
select("location",
"datetime",
"water_level_m")
SPRC_HOBO_volume$datetime <-
as.Date(as.numeric(as.character(SPRC_HOBO_volume$datetime)))
#SPRC_02 water level from Solinst data (Solinsts 8 and 26)
SPRC_wll8 <- read.csv("WS_SPRC_02_h2ohio_wll08_proc-comb.csv")
SPRC_wll26 <- read.csv("WS_SPRC_02_h2ohio_wll26_proc-comb.csv")
SPRC_02_sol <- rbind(SPRC_wll8, SPRC_wll26) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_02")
SPRC_02_sol$datetime <-
as.Date(as.numeric(as.character(SPRC_02_sol$datetime)))
#set unusable dates and remove
unusable1 <- seq(as.Date("2023-12-11"), as.Date("2023-12-16"), by = "day")
unusable2 <- seq(as.Date("2024-04-03"), as.Date("2024-04-17"), by = "day")
unusable3 <- seq(as.Date("2024-11-29"), as.Date("2025-03-10"), by = "day")
unusable_dates <- c(unusable1, unusable2, unusable3)
SPRC_02_sol <- SPRC_02_sol %>%
filter(!as.Date(datetime) %in% unusable_dates)
#SPRC_04 water level from Solinst data (Solinst 6)
SPRC_04_sol_file <- "WS_SPRC_04_h2ohio_wll06_proc-comb.csv"
SPRC_04_sol <- read.csv(SPRC_04_sol_file) %>%
select("datetime",
"LEVEL") %>%
rename_at("LEVEL", ~"water_level_m") %>%
mutate(location = "SPRC_04")
SPRC_04_sol$datetime <-
as.Date(as.numeric(as.character(SPRC_04_sol$datetime)))
#combine SPRC_02 HOBO and Solinst data
SPRC_02_volume <- SPRC_HOBO_volume %>%
#pull out HOBO from North Pool
filter(location == "SPRC_02") %>%
#combine two dfs
rbind(SPRC_02_sol)
#set sensor elevations from data from Morgan
el_change1 <- seq(as.Date("2024-04-17"), as.Date("2024-06-18"), by = "day")
el_change2 <- seq(as.Date("2025-05-28"), as.Date("2025-06-16"), by = "day")
SPRC_02_volume <- SPRC_02_volume %>%
mutate(sensor_el = case_when(datetime %in% el_change1 ~ as.numeric(824.15),
datetime %in% el_change2 ~ as.numeric(823.96),
.default = as.numeric(822)))
